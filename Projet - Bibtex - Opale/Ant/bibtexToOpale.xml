<?xml version="1.0" encoding="UTF-8"?>
<project basedir=".." name="main" default="convert">
    <property name="InputPath" value="C:\\Users\\Pauline\\Documents\\UTC\\GI05 - A14\\NF29\\Projet\\Projet - Bibtex-BibtexXml\\bib2.bib"></property>
    <property name="OutputPath" value="${basedir}\result"></property>
    
    <target name="preparation">
        <delete dir="${basedir}/result"></delete>
        <delete dir="${basedir}/tmp"></delete>
        <mkdir dir="${basedir}/result"></mkdir>
        <mkdir dir="${basedir}/tmp"></mkdir>
    </target>
    
    <target name="BibtexToBibXml" depends="preparation">
        <!-- Convert Bibtex into BibtexXml  -->
        <java
            fork="true"
            failonerror="true" 
            jar="lib\bibtex.jar"
            >
            <arg value="${InputPath}"/>
            <arg value="${basedir}\tmp"/>
            <arg value="\\tmpBibXml.xml"/>
        </java>
    </target>
    
    <target name="BibXmlToHdocBib" depends="BibtexToBibXml">
        <!-- Convert from BibXlm to HdocBib -->
        <xslt classpath="${basedir}/lib/saxon9he.jar" 
            in="${basedir}\tmp\tmpBibXml.xml" out="${basedir}\tmp\tmpHdocBib.xml" 
            xslresource="${basedir}/XSL/BibToHdoc.xsl"></xslt>
    </target>
    
    <target name="convert" depends="BibXmlToHdocBib">
        <!-- Convert from HdocBib to Opale -->
        <xslt in="${basedir}\tmp\tmpHdocBib.xml" 
            out="${basedir}/tmp/tempHdoc.xml" 
            xslresource="${basedir}/XSL/SeparateXmlt.xsl">
            <param name="in" expression="${basedir}\tmp\tmpHdocBib.xml"></param>
            <param name="out" expression="${OutputPath}"></param>
        </xslt>
        <ant antfile="${basedir}/tmp/tempHdoc.xml"/>
        <delete dir="${basedir}/tmp"></delete>
    </target>
    
    
</project>